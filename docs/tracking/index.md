# 記録・再現ガイド

MLflow を中心としたトラッキング基盤を整備するときに登場する用語と実践方法を、前提知識がなくても読み進められるようまとめました。ここでいう「トラッキング」とは、実験結果や設定を忘れないようにメモしておく作業全般を指します。単なるログ保存ではなく、後から同じ条件で実行し直せる状態（再現性）を保つことが目標です。

## このセクションで頻出する用語

| 用語 | 意味 | どう役立つか |
| --- | --- | --- |
| 実験 (Experiment) | 複数の試行（Run）をまとめるフォルダーのような概念。 | プロジェクトや目的ごとに結果をグルーピングできる。 |
| Run | 1 回の学習や評価に関する記録単位。 | パラメータや指標を Run ごとに比較できる。 |
| メタデータ | データに関する説明情報。例: 学習率、使用したデータセット名。 | 後で振り返るときに「何をどう実行したか」を再確認できる。 |
| アーティファクト | 実験が生み出したファイル。モデル、グラフ、ログなど。 | 成果物を Run と紐づけて保管できる。 |
| トラッキングサーバー | Run 情報を保存する MLflow のサーバーアプリケーション。 | 複数人・複数マシンからアクセスし、結果を共有できる。 |
| バックエンドストア | Run 情報を保存するデータベース。 | SQLite や PostgreSQL などを選べる。 |
| アーティファクトストア | アーティファクトを保存する場所。 | ローカルフォルダー、S3、GCS などを利用する。 |

分からない語が出てきたら、この表に戻って確認しながら読み進めてください。

## 推奨ディレクトリー構成

以下は、MLflow Tracking サーバーとクライアントコードを同居させるリポジトリを想定した基本構成です。`infra/` 配下では Terraform などの IaC（Infrastructure as Code: 設定をコードとして管理する考え方）を使ってクラウドリソースを定義するといった拡張も可能です。

```text
tracking/
├── README.md              # 運用ポリシーとオンボーディング手順
├── mlflow/                # MLflow サーバー関連の設定
│   ├── docker-compose.yml # トラッキングサーバー/DB/オブジェクトストレージの定義
│   ├── configs/           # backend-store-uri や artifact-store の設定テンプレート
│   └── scripts/           # サーバー起動・バックアップ・メンテナンススクリプト
├── pipelines/             # 実験パイプライン定義（例: Hydra, Airflow DAG）
│   ├── configs/           # ハイパーパラメータや環境ごとの YAML 設定
│   └── src/               # 実験コード（MLflow Tracking API を呼び出す）
├── notebooks/             # 分析用ノートブック（MLflow Widgets を利用）
├── tests/                 # ロギングやメタデータ検証の自動テスト
└── docs/                  # ドキュメント（運用 Runbook、ベストプラクティス）
```

### 構成の意図を平易に説明

- `mlflow/` にトラッキングサーバーのライフサイクル（起動・停止・バックアップ）を集約すると、担当者が変わっても迷いません。
- `pipelines/` では設定ファイルとコードを分け、同じプログラムでもパラメータを差し替えるだけで別の Run を作れるようにします。
- `tests/` で自動テストを走らせ、ログ API の破壊的変更やメタデータの欠損を早期に検知します。
- `docs/` 配下に Runbook（障害対応の手順書）を置き、チーム全体で共通の運用方法を共有します。

## ドキュメントの構成

このセクションでは、以下のページで MLflow 公式ドキュメントに倣いつつ、用語の意味をかみ砕いて解説します。

- [MLflow Tracking](mlflow-tracking.md) — Run を保存・検索する仕組みとよく出る単語を説明。
- [MLflow Projects](mlflow-projects.md) — MLflow 形式で実験コードをパッケージ化する方法を、設定ファイルの語句から整理。
- [MLflow Model Registry](mlflow-model-registry.md) — モデルの登録・承認フローを、ステージ名など専門用語の解説付きで紹介。

どのページでも次の観点を取り上げています。

1. **概要** – 専門用語を説明しながら、ライブラリが解決する課題を説明。
2. **インストール** – 必要なコマンドと、出てくる単語（依存関係、ストレージなど）の意味を補足。
3. **クイックスタート** – 簡単なコード例を示し、各ステップが何をしているのかを言葉で解きほぐす。
4. **主要コンセプト** – 表形式で用語の意味を整理。
5. **ベストプラクティス** – 実務でありがちな疑問を平易な文章で回答。
6. **関連リファレンス** – 詳細を知りたいときの参照先。

各ページは「専門用語辞書 → 手順 → より深い話題」という順番で構成し、言葉の意味が分からなくて詰まる状況を避けています。
